<!doctype html><html lang=zh-tw dir=content/zh-tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=content-security-policy content="upgrade-insecure-requests"><title>linux centos 常用指令 - 補覺鳴詩</title><meta name=keywords content="infra"><meta name=author content="Owan"><meta property="og:title" content="linux centos 常用指令"><meta property="og:site_name" content="補覺鳴詩"><meta property="og:image" content="/img/author.jpg"><meta name=title content="linux centos 常用指令 - 補覺鳴詩"><meta name=description content="日常紀錄"><link rel="shortcut icon" href=/img/favicon.ico><link rel=apple-touch-icon href=/img/apple-touch-icon.png><link rel=apple-touch-icon-precomposed href=/img/apple-touch-icon.png><link href=//cdn.bootcdn.net/ajax/libs/font-awesome/4.6.2/css/font-awesome.min.css rel=stylesheet type=text/css><link href=//cdn.bootcdn.net/ajax/libs/imageviewer/0.1.0/viewer.min.css rel=stylesheet><link href=/css/main.css rel=stylesheet type=text/css><link href=/css/syntax.css rel=stylesheet type=text/css></head><body itemscope itemtype=http://schema.org/WebPage lang=zh-hans><div class="container one-collumn sidebar-position-left page-home"><div class=headband></div><header id=header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle role=button style=opacity:1;top:0><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><div class=multi-lang-switch><i class="fa fa-fw fa-language" style=margin-right:5px></i></div><div class=custom-logo-site-title><a href=/ class=brand rel=start><span class=logo-line-before><i></i></span>
<span class=site-title>補覺鳴詩</span>
<span class=logo-line-after><i></i></span></a></div><p class=site-subtitle>學海無涯</p></div><div class=site-nav-right><div class="toggle popup-trigger" style=opacity:1;top:0><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul id=menu class=menu><li class=menu-item><a href=/ rel=section><i class="menu-item-icon fa fa-fw fa-home"></i><br>首頁</a></li><li class=menu-item><a href=/post rel=section><i class="menu-item-icon fa fa-fw fa-archive"></i><br>archive</a></li><li class=menu-item><a href=/about.html rel=section><i class="menu-item-icon fa fa-fw fa-user"></i><br>關於我</a></li><li class="menu-item menu-item-search"><a href=javascript:; class=popup-trigger><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜尋</a></li></ul><div class=site-search><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class=search-icon><i class="fa fa-search"></i></span>
<span class=popup-btn-close><i class="fa fa-times-circle"></i></span><div class=local-search-input-wrapper><input autocomplete=off placeholder=搜索關鍵字... spellcheck=false type=text id=local-search-input autocapitalize=none autocorrect=off></div></div><div id=local-search-result></div></div></div></nav></div></header><main id=main class=main><div class=main-inner><div class=content-wrap><div id=content class=content><section id=posts class=posts-expand><article class="post post-type-normal" itemscope itemtype=http://schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline"><a class=post-title-link href=https://lovesharepc.github.io/post/linux_centos_%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4.html itemprop=url>linux centos 常用指令</a></h1><div class=post-meta><span class=post-time><i class="fa fa-calendar-o fa-fw"></i>
<span class=post-meta-item-text>時間：</span>
<time itemprop=dateCreated datetime=2016-03-22T13:04:35+08:00 content="2022-02-21">2022-02-21</time></span>
<span class=post-category>&nbsp; | &nbsp;
<i class="fa fa-folder-o fa-fw"></i>
<span class=post-meta-item-text>分類：</span>
<span itemprop=about itemscope itemtype=https://schema.org/Thing><a href=/categories/linux itemprop=url rel=index style=text-decoration:underline><span itemprop=name>linux</span></a>
&nbsp;</span>
<span itemprop=about itemscope itemtype=https://schema.org/Thing><a href=/categories/centos itemprop=url rel=index style=text-decoration:underline><span itemprop=name>centos</span></a>
&nbsp;</span>
<span itemprop=about itemscope itemtype=https://schema.org/Thing><a href=/categories/rocky-linux itemprop=url rel=index style=text-decoration:underline><span itemprop=name>rocky linux</span></a>
&nbsp;</span></span>
<span>|
<i class="fa fa-file-word-o fa-fw"></i>
<span class=post-meta-item-text>字數：</span>
<span class=leancloud-world-count>2276 字</span></span>
<span>|
<i class="fa fa-eye fa-fw"></i>
<span class=post-meta-item-text>閱讀：</span>
<span class=leancloud-view-count>5分鐘</span></span>
<span id=/post/linux_centos_%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4.html class=leancloud_visitors data-flag-title="linux centos 常用指令">|
<i class="fa fa-binoculars fa-fw"></i>
<span class=post-meta-item-text>閱讀次數：</span>
<span class=leancloud-visitors-count></span></span></div></header><div class=post-body itemprop=articleBody><p><img src=linux_centos_%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4/cat_linux.jpg alt>
紀錄 linux 指令</p><h2 id=virtualbox-guest-additions>virtualbox guest additions</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>dnf install -y epel-release 
</span></span><span style=display:flex><span>dnf install -y gcc make perl kernel-devel kernel-headers bzip2 dkms
</span></span><span style=display:flex><span>dnf install gcc kernel-devel kernel-headers make bzip2 perl 
</span></span><span style=display:flex><span>reboot
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mkdir -p /tmp/iso
</span></span><span style=display:flex><span>mount /dev/cdrom /tmp/iso
</span></span><span style=display:flex><span>sh /tmp/iso/VBoxLinuxAdditions.run
</span></span></code></pre></div><h2 id=監控類>監控類</h2><h3 id=journalctl>journalctl</h3><p>Tail Systemd Service Logs using Journalctl</p><p>Show all systemd journal logs:
$ journalctl</p><p>Display logs for the current boot only:
$ journalctl -b</p><p>Display logs for the previous boot:
$ journalctl -b=-1</p><p>Tail last 100 lines of systemd logs for particular service (equiv. tail -n 100):
$ journalctl -u docker.service -n 100 &ndash;no-pager</p><p>Follow systemd logs for service (equiv. tail -f):
$ journalctl -u docker.service -f</p><p>Show systemd logs for service since today, since yesterday, etc.:
$ journalctl -u docker.service -S today
$ journalctl -u docker.service -S yesterday
$ journalctl -u docker.service -S &ldquo;1 hour ago&rdquo;
$ journalctl -u docker.service -S &ldquo;2 days ago&rdquo;</p><p>Show logs between two dates:
$ journalctl -u docker.service -S &ldquo;2020-01-16 18:00:00&rdquo; -U &ldquo;2020-01-17 23:00:00&rdquo;</p><p>Grep journalctl service logs:
$ journalctl -u docker.service | grep -i error</p><h3 id=iostat>iostat</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>dnf install sysstat
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[root@localhost local]# iostat -hx 10
</span></span><span style=display:flex><span>Linux 4.18.0-358.el8.x86_64 (localhost.localdomain)     01/17/2022      _x86_64_        (2 CPU)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>avg-cpu:  %user   %nice %system %iowait  %steal   %idle
</span></span><span style=display:flex><span>           0.1%    0.0%    0.2%    0.0%    0.0%   99.7%
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>     r/s     w/s     rkB/s     wkB/s   rrqm/s   wrqm/s  %rrqm  %wrqm r_await w_await aqu-sz rareq-sz wareq-sz  svctm  %util Device
</span></span><span style=display:flex><span>    0.04    0.12      1.6k     39.2k     0.00     0.02   0.7%  16.4%    1.56  102.91   0.01    40.7k   324.4k   2.62   0.0% sda
</span></span><span style=display:flex><span>    0.04    0.12      1.4k     39.2k     0.00     0.00   0.0%   0.0%    1.38   60.94   0.01    39.9k   314.8k   2.06   0.0% dm-0
</span></span><span style=display:flex><span>    0.00    0.00      0.0k      0.0k     0.00     0.00   0.0%   0.0%    0.51   49.91   0.00    15.3k     4.0k   1.66   0.0% dm-1
</span></span></code></pre></div><h2 id=centos-8-python>centos 8 python</h2><p>路徑
/usr/libexec/platform-python
wget <a href=https://bootstrap.pypa.io/pip/3.6/get-pip.py>https://bootstrap.pypa.io/pip/3.6/get-pip.py</a>
/usr/libexec/platform-python get-pip.py</p><h3 id=網路流量>網路流量</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>[root@localhost local]# sar -n DEV 1
</span></span><span style=display:flex><span>Linux 4.18.0-358.el8.x86_64 (localhost.localdomain)     01/17/2022      _x86_64_        (2 CPU)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>11:16:10 AM     IFACE   rxpck/s   txpck/s    rxkB/s    txkB/s   rxcmp/s   txcmp/s  rxmcst/s   %ifutil
</span></span><span style=display:flex><span>11:16:11 AM        lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00
</span></span><span style=display:flex><span>11:16:11 AM    ens192     18.00      1.00      1.23      0.10      0.00      0.00      0.00      0.00
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># 網卡速度
</span></span><span style=display:flex><span>root@pve1:~# ethtool ens192
</span></span><span style=display:flex><span>Settings for ens192:
</span></span><span style=display:flex><span>Supported ports: [ TP ]
</span></span><span style=display:flex><span>Supported link modes:   1000baseT/Full
</span></span><span style=display:flex><span>                        10000baseT/Full
</span></span><span style=display:flex><span>Supported pause frame use: No
</span></span><span style=display:flex><span>Supports auto-negotiation: No
</span></span><span style=display:flex><span>Advertised link modes:  Not reported
</span></span><span style=display:flex><span>Advertised pause frame use: No
</span></span><span style=display:flex><span>Advertised auto-negotiation: No
</span></span><span style=display:flex><span>Speed: 10000Mb/s
</span></span><span style=display:flex><span>Duplex: Full
</span></span><span style=display:flex><span>Port: Twisted Pair
</span></span><span style=display:flex><span>PHYAD: 0
</span></span><span style=display:flex><span>Transceiver: internal
</span></span><span style=display:flex><span>Auto-negotiation: off
</span></span><span style=display:flex><span>MDI-X: Unknown
</span></span><span style=display:flex><span>Supports Wake-on: uag
</span></span><span style=display:flex><span>Wake-on: d
</span></span><span style=display:flex><span>Link detected: yes
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>root@pve1:~# cat /sys/class/net/ens192/speed
</span></span><span style=display:flex><span>10000
</span></span></code></pre></div><h2 id=帳號控制>帳號控制</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>chage  (帳號原則)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>usermod  unlock 
</span></span></code></pre></div><h2 id=repository>Repository</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span># third-party (httpd 、 nginx)
</span></span><span style=display:flex><span>https://codeit.guru/en_US/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>#  EPEL (Extra Packages for Enterprise Linux)
</span></span><span style=display:flex><span>yum -y install epel-release
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># for centos 8 stream
</span></span><span style=display:flex><span>dnf install epel-next-release
</span></span></code></pre></div><h2 id=多工指令>多工指令</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span># Move Running Command in Background (pause)
</span></span><span style=display:flex><span>CTRL + Z
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># type bg command on terminal
</span></span><span style=display:flex><span>root@tecadmin:~$ bg
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># list all jobs running
</span></span><span style=display:flex><span>root@tecadmin:~$ jobs
</span></span><span style=display:flex><span>[1]+  Running                 tar czf log-backup.tar.gz /var/log &amp;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>#Move Background Commands to Foreground (Terminal)
</span></span><span style=display:flex><span>root@tecadmin:~$ fg 1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>#running in backguard
</span></span><span style=display:flex><span>tar -czf home.tar.gz . &amp;
</span></span><span style=display:flex><span>jobs
</span></span></code></pre></div><h2 id=時間>時間</h2><p>timezone</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span># 查詢目前設定
</span></span><span style=display:flex><span>timedatectl
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># 查詢可用時區
</span></span><span style=display:flex><span>timedatectl list-timezones | grep Asia
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># 設定時區
</span></span><span style=display:flex><span>sudo timedatectl set-timezone Asia/Taipei
</span></span></code></pre></div><p>NTP</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>NTP 
</span></span><span style=display:flex><span>yum install chrony  -y
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>nano /etc/chrony.conf
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># as NTP server
</span></span><span style=display:flex><span>allow 0.0.0.0/0
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># as NTP client
</span></span><span style=display:flex><span>server &lt;IP address of the NTP server&gt; iburst
</span></span><span style=display:flex><span>maxdistance 16.0
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>systemctl restart chronyd
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>firewall-cmd --zone=public --add-port=123/udp --permanent
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>chronyc makestep
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># 確認 NTP 狀態
</span></span><span style=display:flex><span>chronyc tracking
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[root@libreNMS ~]#  chronyc sources -v
</span></span><span style=display:flex><span>MS Name/IP address         Stratum Poll Reach LastRx Last sample
</span></span><span style=display:flex><span>===============================================================================
</span></span><span style=display:flex><span>^+ 242-184-213-49.tinp.net.&gt;     2   6    17     3   -192us[ -214us] +/- 6802us
</span></span><span style=display:flex><span>^- 103.147.23.5                  2   6    17     2  -4595us[-4617us] +/-   14ms
</span></span><span style=display:flex><span>^- time.cloudflare.com           3   6    17     3   +432us[ +484us] +/-   58ms
</span></span><span style=display:flex><span>^* twtpe2-ntp-002.aaplimg.c&gt;     1   6    17     1  +1188us[+1166us] +/- 3527us
</span></span></code></pre></div><h2 id=mount>Mount</h2><p>cifs SMB</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>yum install cifs-utils
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mount -t cifs -o username=chw,password=&lt;win_share_password&gt;,domain=&lt;win_domain&gt;,vers=3.0 //10.201.100.49/iso /cifs
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>## /etc/fstab
</span></span><span style=display:flex><span>//192.168.56.1/testdir /mnt/win cifs rw,suid,dir_mode=0777,file_mode=0777,username=帳號,password=密碼 0 0
</span></span></code></pre></div><h2 id=du-查空間>du 查空間</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span># 目錄大小
</span></span><span style=display:flex><span>du */ -sh
</span></span><span style=display:flex><span>sudo du -hs .[a-z]* va* *
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>#磁碟大小
</span></span><span style=display:flex><span>df -Th
</span></span><span style=display:flex><span>#磁碟 map
</span></span><span style=display:flex><span>lsblk
</span></span><span style=display:flex><span>#磁碟 ID
</span></span><span style=display:flex><span>blkid
</span></span></code></pre></div><h2 id=yum>yum</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span># 找版本
</span></span><span style=display:flex><span>dnf search openjdk
</span></span><span style=display:flex><span>yum  group
</span></span><span style=display:flex><span>[root@ELK27 pa_config]# yum grouplist
</span></span><span style=display:flex><span>Last metadata expiration check: 0:01:55 ago on Sun 08 Aug 2021 11:03:05 AM CST.
</span></span><span style=display:flex><span>Available Environment Groups:
</span></span><span style=display:flex><span>   Server with GUI
</span></span><span style=display:flex><span>   Server
</span></span><span style=display:flex><span>   Workstation
</span></span><span style=display:flex><span>   Virtualization Host
</span></span><span style=display:flex><span>   Custom Operating System
</span></span><span style=display:flex><span>Installed Environment Groups:
</span></span><span style=display:flex><span>   Minimal Install
</span></span><span style=display:flex><span>Available Groups:
</span></span><span style=display:flex><span>   Container Management
</span></span><span style=display:flex><span>   .NET Core Development
</span></span><span style=display:flex><span>   RPM Development Tools
</span></span><span style=display:flex><span>   Development Tools
</span></span><span style=display:flex><span>   Graphical Administration Tools
</span></span><span style=display:flex><span>   Headless Management
</span></span><span style=display:flex><span>   Legacy UNIX Compatibility
</span></span><span style=display:flex><span>   Network Servers
</span></span><span style=display:flex><span>   Scientific Support
</span></span><span style=display:flex><span>   Security Tools
</span></span><span style=display:flex><span>   Smart Card Support
</span></span><span style=display:flex><span>   System Tools
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[root@ELK27 pa_config]# yum groups info &#34;Minimal Install&#34;
</span></span><span style=display:flex><span>Last metadata expiration check: 0:03:19 ago on Sun 08 Aug 2021 11:03:05 AM CST.
</span></span><span style=display:flex><span>Environment Group: Minimal Install
</span></span><span style=display:flex><span> Description: Basic functionality.
</span></span><span style=display:flex><span> Mandatory Groups:
</span></span><span style=display:flex><span>   Core
</span></span><span style=display:flex><span> Optional Groups:
</span></span><span style=display:flex><span>   Guest Agents
</span></span><span style=display:flex><span>   Standard
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[root@ELK27 pa_config]# yum groups info &#34;Guest Agents&#34;
</span></span><span style=display:flex><span>Last metadata expiration check: 0:05:47 ago on Sun 08 Aug 2021 11:03:05 AM CST.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Group: Guest Agents
</span></span><span style=display:flex><span> Description: Agents used when running under a hypervisor.
</span></span><span style=display:flex><span> Mandatory Packages:
</span></span><span style=display:flex><span>   hyperv-daemons
</span></span><span style=display:flex><span>   open-vm-tools
</span></span><span style=display:flex><span>   qemu-guest-agent
</span></span></code></pre></div><h2 id=網路設定-nmcli>網路設定 nmcli</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>查看設定
</span></span><span style=display:flex><span># IP
</span></span><span style=display:flex><span>nmcli
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># device
</span></span><span style=display:flex><span>nmcli device show
</span></span></code></pre></div><h2 id=其他>其他</h2><h3 id=tcpdump>tcpdump</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>tcpdump -i ens160 -vv port 514 | grep &lt;ip-address&gt;
</span></span></code></pre></div><h3 id=proxy>Proxy</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>PROXY
</span></span><span style=display:flex><span>export http_proxy=http://172.28.11.112:3128/
</span></span><span style=display:flex><span>echo &#34;http_proxy=http://172.28.11.112:3128/&#34; &gt; /etc/environment
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Linux 使用全域 Proxy 上網 (with only apt/yum)
</span></span><span style=display:flex><span>2016-12-16 CENTOS, UBUNTU
</span></span><span style=display:flex><span>這一兩天遇到 Server 必須要用 HTTP Proxy 才能上網，順手紀錄一下如何設定
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>使用 export http_proxy / https_proxy 的方式代理
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>全域變數 http_proxy / https_proxy
</span></span><span style=display:flex><span>1    # 暫時生效，重開機proxy就會失效
</span></span><span style=display:flex><span>2    $ export http_proxy=http://proxy.example.com
</span></span><span style=display:flex><span>3     
</span></span><span style=display:flex><span>4    # https用https_proxy
</span></span><span style=display:flex><span>5    $ export https_proxy=https://proxy.example.com
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>設定永久變數
</span></span><span style=display:flex><span>• 僅在目前使用者
</span></span><span style=display:flex><span>永久變數可以寫在登入後會讀取的 ~/.bash_profile , ~/.bashrc
</span></span><span style=display:flex><span>1    $ echo &#34;export http_proxy=http://proxy.example.com&#34; &gt;&gt; ~/.bashrc
</span></span><span style=display:flex><span>2    $ echo &#34;export https_proxy=https://proxy.example.com&#34; &gt;&gt; ~/.bashrc
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>• 針對所有使用者
</span></span><span style=display:flex><span>如果要讓這台主機的所有 http / https 都走 proxy 就設定在 /etc/profile
</span></span><span style=display:flex><span>1    $ echo &#34;export http_proxy=http://proxy.example.com&#34; &gt;&gt; /etc/profile
</span></span><span style=display:flex><span>2    $ echo &#34;export https_proxy=https://proxy.example.com&#34; &gt;&gt; /etc/profile
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>• 僅 apt or yum 使用時才用 proxy
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># YUM setting
</span></span><span style=display:flex><span>$ vim /etc/yum.conf
</span></span><span style=display:flex><span>proxy=http://proxy.example.com
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># APT setting
</span></span><span style=display:flex><span>$ vim /etc/apt/apt.conf
</span></span><span style=display:flex><span>Acquire::http::Proxy &#34;http://proxy.example.com&#34;;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>如果需要驗證的格式為
</span></span><span style=display:flex><span>1    # 變數=http://使用者帳號:密碼@伺服器位址:端口
</span></span><span style=display:flex><span>2    http_proxy=http://user:pass@proxy.example.com:80
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>https 以此類推。
</span></span></code></pre></div><p>來自 <a href=https://shazi.info/linux-%E4%BD%BF%E7%94%A8%E5%85%A8%E5%9F%9F-proxy-%E4%B8%8A%E7%B6%B2-with-only-aptyum/>https://shazi.info/linux-%E4%BD%BF%E7%94%A8%E5%85%A8%E5%9F%9F-proxy-%E4%B8%8A%E7%B6%B2-with-only-aptyum/</a></p><h3 id=系統版本>系統版本</h3><p>看 kernel version</p><blockquote><p>cat /proc/version
uname -a</p></blockquote><p>System version</p><blockquote><p>cat /etc/os-release</p></blockquote><h3 id=openjdk>openjdk</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>cd /usr/lib/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>wget  https://download.java.net/java/GA/jdk14.0.1/664493ef4a6946b186ff29eb326336a2/7/GPL/openjdk-14.0.1_linux-x64_bin.tar.gz
</span></span><span style=display:flex><span>tar xvf openjdk-14*.tar.gz &amp;&amp; rm -f openjdk-14*.tar.gz
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>echo &#34;JAVA_HOME=/usr/lib/jdk-14.0.1/&#34; &gt;&gt; ~/.bashrc
</span></span><span style=display:flex><span>echo &#34;PATH=$PATH:$JAVA_HOME/bin/&#34; &gt;&gt; ~/.bashrc
</span></span><span style=display:flex><span>source ~/.bashrc
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>reboot
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>java -version
</span></span></code></pre></div><h3 id=dnsperf>dnsperf</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>[root@wiznote dnsperf-2.4.0]# sudo dnf copr enable @dnsoarc/dnsperf
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>wget https://download-ib01.fedoraproject.org/pub/epel/8/Everything/x86_64/Packages/c/ck-0.6.0-9.el8.x86_64.rpm
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[root@wiznote dnsperf-2.4.0]# sudo dnf install dnsperf
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[root@elk-uat-old dnsperf]# dnsperf -h
</span></span><span style=display:flex><span>DNS Performance Testing Tool
</span></span><span style=display:flex><span>Version 2.3.4
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Usage: dnsperf [-f family] [-m mode] [-s server_addr] [-p port]
</span></span><span style=display:flex><span>               [-a local_addr] [-x local_port] [-d datafile] [-c clients]
</span></span><span style=display:flex><span>               [-T threads] [-n maxruns] [-l timelimit] [-b buffer_size]
</span></span><span style=display:flex><span>               [-t timeout] [-e] [-E code:value] [-D]
</span></span><span style=display:flex><span>               [-y [alg:]name:secret] [-q num_queries] [-Q max_qps]
</span></span><span style=display:flex><span>               [-S stats_interval] [-u] [-v] [-h]
</span></span><span style=display:flex><span>  -f address family of DNS transport, inet or inet6 (default: any)
</span></span><span style=display:flex><span>  -m set transport mode: udp, tcp or tls (default: udp)
</span></span><span style=display:flex><span>  -s the server to query (default: 127.0.0.1)
</span></span><span style=display:flex><span>  -p the port on which to query the server (default: udp/tcp 53 or tls 853)
</span></span><span style=display:flex><span>  -a the local address from which to send queries
</span></span><span style=display:flex><span>  -x the local port from which to send queries (default: 0)
</span></span><span style=display:flex><span>  -d the input data file (default: stdin)
</span></span><span style=display:flex><span>  -c the number of clients to act as
</span></span><span style=display:flex><span>  -T the number of threads to run
</span></span><span style=display:flex><span>  -n run through input at most N times
</span></span><span style=display:flex><span>  -l run for at most this many seconds
</span></span><span style=display:flex><span>  -b socket send/receive buffer size in kilobytes
</span></span><span style=display:flex><span>  -t the timeout for query completion in seconds (default: 5)
</span></span><span style=display:flex><span>  -e enable EDNS 0
</span></span><span style=display:flex><span>  -E send EDNS option
</span></span><span style=display:flex><span>  -D set the DNSSEC OK bit (implies EDNS)
</span></span><span style=display:flex><span>  -y the TSIG algorithm, name and secret
</span></span><span style=display:flex><span>  -q the maximum number of queries outstanding (default: 100)
</span></span><span style=display:flex><span>  -Q limit the number of queries per second
</span></span><span style=display:flex><span>  -S print qps statistics every N seconds
</span></span><span style=display:flex><span>  -u send dynamic updates instead of queries
</span></span><span style=display:flex><span>  -v verbose: report each query and additional information to stdout
</span></span><span style=display:flex><span>  -h print this help
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>#####
</span></span><span style=display:flex><span>wget https://www.dns-oarc.net/files/dnsperf/data/queryfile-example-10million-201202.gz
</span></span><span style=display:flex><span>tar xvf queryfile-example-10million-201202.gz
</span></span><span style=display:flex><span>gzip -d  queryfile-example-10million-201202.gz
</span></span><span style=display:flex><span>#####
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>### 每秒 10000 次查詢 維持 60 秒
</span></span><span style=display:flex><span>dnsperf -s 10.201.102.2 -d queryfile-example-10million-201202 -q 10000 -l 60
</span></span></code></pre></div><h3 id=firewall-cmd>firewall-cmd</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>#新增規則
</span></span><span style=display:flex><span>firewall-cmd --permanent --add-service=ftp
</span></span><span style=display:flex><span>firewall-cmd --permanent --add-port=3690/tcp
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>#移除規則
</span></span><span style=display:flex><span>firewall-cmd --permanent --remove-service=ftp
</span></span><span style=display:flex><span>firewall-cmd --permanent --remove-port=3690/tcp
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>#列出規則
</span></span><span style=display:flex><span>firewall-cmd --list-all
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>#套用規則
</span></span><span style=display:flex><span>firewall-cmd --reload
</span></span><span style=display:flex><span>設定 IP
</span></span><span style=display:flex><span>cd /etc/sysconfig/network-scripts
</span></span></code></pre></div><h3 id=lvm-修復>LVM 修復</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>
</span></span><span style=display:flex><span>Rescue Mode 中修復
</span></span><span style=display:flex><span>vgscan 
</span></span><span style=display:flex><span>vgchange -a y centos
</span></span><span style=display:flex><span>xfs_repair -L  /dev/centos/root
</span></span><span style=display:flex><span>mkdir /mnt/test &amp;&amp; mount /dev/centos/root /mnt/test
</span></span></code></pre></div><h3 id=local-domain-resolve>local domain Resolve</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>sudo vi /etc/nsswitch.conf
</span></span><span style=display:flex><span>hosts:          files dns myhostname
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sudo vi /etc/systemd/resolved.conf
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[Resolve]
</span></span><span style=display:flex><span>Domains=weicloud.local
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>relink
</span></span><span style=display:flex><span>sudo ln -sf /run/systemd/resolve/resolv.conf /etc/resolv.conf
</span></span></code></pre></div><h3 id=samba>SAMBA</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>yum install samba samba-client samba-common 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># diable selinux
</span></span><span style=display:flex><span>firewall-cmd --permanent --add-service=samba
</span></span><span style=display:flex><span>sed -i s/SELINUX=enforcing/SELINUX=disabled/g /etc/selinux/config
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cd /etc/samba/
</span></span><span style=display:flex><span>mv smb.conf smb.conf.bak
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>vi smb.conf
</span></span><span style=display:flex><span>[global]
</span></span><span style=display:flex><span>    workgroup = MYGROUP
</span></span><span style=display:flex><span>    server string = Samba Server Version %v
</span></span><span style=display:flex><span>    security = USER
</span></span><span style=display:flex><span>    map to guest = Bad User
</span></span><span style=display:flex><span>    log file = /var/log/samba/log.%m
</span></span><span style=display:flex><span>    max log size = 50
</span></span><span style=display:flex><span>    idmap config * : backend = tdb
</span></span><span style=display:flex><span>    cups options = raw
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># User defined share 
</span></span><span style=display:flex><span>[public]
</span></span><span style=display:flex><span>    path = /home/public
</span></span><span style=display:flex><span>    read only = No
</span></span><span style=display:flex><span>    guest ok = Yes
</span></span><span style=display:flex><span>    browseable = Yes 
</span></span><span style=display:flex><span>    public = Yes
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cd /home
</span></span><span style=display:flex><span>mkdir public
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>We change the owner of the folder and its permissions:
</span></span><span style=display:flex><span>chown nobody:nobody public/
</span></span><span style=display:flex><span>chmod 777 public/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Enabling the needed services and starting them.
</span></span><span style=display:flex><span>systemctl enable smb.service
</span></span><span style=display:flex><span>systemctl enable nmb.service
</span></span><span style=display:flex><span>systemctl restart smb.service
</span></span><span style=display:flex><span>systemctl restart nmb.service
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Allowing samba through our firewall.
</span></span><span style=display:flex><span>firewall-cmd --permanent --add-service=samba
</span></span><span style=display:flex><span>firewall-cmd --reload
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mount
</span></span><span style=display:flex><span>mount -t cifs -o username=&lt;your_username&gt;,password=&lt;your_password&gt; //server/share /mountpoint
</span></span></code></pre></div><h3 id=redhat-59-rsyslog>redhat 5.9 rsyslog</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>install rsyslog
</span></span><span style=display:flex><span>mkdir iso
</span></span><span style=display:flex><span>mount /dev/cdrom /iso
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>rpm -ivh ./rsyslog-3.22.1-7.el5.x86_64.rpm
</span></span><span style=display:flex><span>service syslog stop
</span></span><span style=display:flex><span>service rsyslog start
</span></span><span style=display:flex><span>chkconfig rsyslog on
</span></span><span style=display:flex><span>chkconfig syslog off
</span></span></code></pre></div><h3 id=aliases>Aliases</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>nano ~/.bashrc
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/etc/bash.bashrc
</span></span><span style=display:flex><span>alias bitfusion4G=&#34;bitfusion run -n 1 -m 4096&#34;
</span></span></code></pre></div><h3 id=screen>screen</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>yum install epel-release
</span></span><span style=display:flex><span>yum install screen
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>screen
</span></span><span style=display:flex><span>screen -r
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>https://blog.gtwang.org/linux/screen-command-examples-to-manage-linux-terminals/
</span></span></code></pre></div><h3 id=coredns--server>coreDNS server</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>https://github.com/coredns/coredns/releases/tag/v1.8.3
</span></span><span style=display:flex><span>wget https://github.com/coredns/coredns/releases/download/v1.8.3/coredns_1.8.3_linux_amd64.tgz
</span></span><span style=display:flex><span>tar zxvf coredns_*
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>nano Corefile
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.:53 {
</span></span><span style=display:flex><span>    forward . 8.8.8.8 9.9.9.9
</span></span><span style=display:flex><span>    log
</span></span><span style=display:flex><span>    errors
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span># Load hosts file inlined in Corefile.
</span></span><span style=display:flex><span># domain:example.com 、weicloud.local
</span></span><span style=display:flex><span>1.hosts adcmuh.org.tw in-addr.arpa ip6.arpa {
</span></span><span style=display:flex><span>    hosts {
</span></span><span style=display:flex><span>        10.17.1.100 sfo-m01-vc01.adcmuh.org.tw
</span></span><span style=display:flex><span>        fallthrough in-addr.arpa ip6.arpa
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=mtu-test>MTU test</h3><blockquote><p>ping -M do -s 8972 <host>1452 正常</p></blockquote><h3 id=webmin>webmin</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>nano /etc/yum.repos.d/webmin.repo
</span></span><span style=display:flex><span>[Webmin]
</span></span><span style=display:flex><span>name=Webmin Distribution Neutral
</span></span><span style=display:flex><span>#baseurl=https://download.webmin.com/download/yum
</span></span><span style=display:flex><span>mirrorlist=https://download.webmin.com/download/yum/mirrorlist
</span></span><span style=display:flex><span>enabled=1
</span></span><span style=display:flex><span>安裝
</span></span><span style=display:flex><span>wget https://download.webmin.com/jcameron-key.asc
</span></span><span style=display:flex><span>rpm --import jcameron-key.asc
</span></span><span style=display:flex><span>yum -y install webmin 
</span></span></code></pre></div><h3 id=iscsi>iSCSI</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>target = server
</span></span><span style=display:flex><span>initiator = client
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>server 
</span></span><span style=display:flex><span>https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/storage_administration_guide/online-storage-management#osm-target-setup
</span></span><span style=display:flex><span>yum install -y targetcli
</span></span><span style=display:flex><span>systemctl start target.service
</span></span><span style=display:flex><span>systemctl enable target.service
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[root@iscsi ~]# targetcli
</span></span><span style=display:flex><span>targetcli shell version 2.1.53
</span></span><span style=display:flex><span>Copyright 2011-2013 by Datera, Inc and others.
</span></span><span style=display:flex><span>For help on commands, type &#39;help&#39;.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/&gt; ls
</span></span><span style=display:flex><span>o- / ......................................................................................................................... [...]
</span></span><span style=display:flex><span>  o- backstores .............................................................................................................. [...]
</span></span><span style=display:flex><span>  | o- block .................................................................................................. [Storage Objects: 0]
</span></span><span style=display:flex><span>  | o- fileio ................................................................................................. [Storage Objects: 0]
</span></span><span style=display:flex><span>  | o- pscsi .................................................................................................. [Storage Objects: 0]
</span></span><span style=display:flex><span>  | o- ramdisk ................................................................................................ [Storage Objects: 0]
</span></span><span style=display:flex><span>  o- iscsi ............................................................................................................ [Targets: 0]
</span></span><span style=display:flex><span>  o- loopback ......................................................................................................... [Targets: 0]
</span></span><span style=display:flex><span>/&gt; backstores/fileio create test /tmp/test.img 10G
</span></span><span style=display:flex><span>Created fileio test with size 10737418240
</span></span><span style=display:flex><span>/&gt; iscsi/ create
</span></span><span style=display:flex><span>Created target iqn.2003-01.org.linux-iscsi.iscsi.x8664:sn.6f68b6498ffb.
</span></span><span style=display:flex><span>Created TPG 1.
</span></span><span style=display:flex><span>Global pref auto_add_default_portal=true
</span></span><span style=display:flex><span>Created default portal listening on all IPs (0.0.0.0), port 3260.
</span></span><span style=display:flex><span>/&gt; cd iscsi/iqn.2003-01.org.linux-iscsi.iscsi.x8664:sn.6f68b6498ffb/tpg1/
</span></span><span style=display:flex><span>/iscsi/iqn.20...b6498ffb/tpg1&gt; luns/ create /backstores/fileio/test
</span></span><span style=display:flex><span>Created LUN 0.
</span></span><span style=display:flex><span>/iscsi/iqn.20...b6498ffb/tpg1&gt; set attribute generate_node_acls=1
</span></span><span style=display:flex><span>Parameter generate_node_acls is now &#39;1&#39;.
</span></span><span style=display:flex><span>/iscsi/iqn.20...b6498ffb/tpg1&gt; set attribute demo_mode_write_protect=0
</span></span><span style=display:flex><span>Parameter demo_mode_write_protect is now &#39;0&#39;.
</span></span><span style=display:flex><span>/iscsi/iqn.20...b6498ffb/tpg1&gt; exit
</span></span><span style=display:flex><span>Global pref auto_save_on_exit=true
</span></span><span style=display:flex><span>Configuration saved to /etc/target/saveconfig.json
</span></span></code></pre></div><h3 id=rsync>Rsync</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span># 無認證
</span></span><span style=display:flex><span>yum install rsync
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># config
</span></span><span style=display:flex><span> [ftp]
</span></span><span style=display:flex><span>        path = /home/ftp
</span></span><span style=display:flex><span>        comment = ftp export area
</span></span><span style=display:flex><span>        read only = no
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mkdir /home/ftp
</span></span><span style=display:flex><span>chown /home/ftp
</span></span><span style=display:flex><span>sysstemctl start rsyncd
</span></span><span style=display:flex><span>sysstemctl enable rsyncd
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># 語法
</span></span><span style=display:flex><span>rsync -arvzh /home/joseph/public/www  SERVER_IP_ADDRESS::ftp 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>認證版
</span></span><span style=display:flex><span> [ftp]
</span></span><span style=display:flex><span>        uid = nobody
</span></span><span style=display:flex><span>        gid = nobody
</span></span><span style=display:flex><span>        path = /home/ftp
</span></span><span style=display:flex><span>        comment = ftp export area
</span></span><span style=display:flex><span>        read only = no
</span></span><span style=display:flex><span>        auth users = ftpuser
</span></span><span style=display:flex><span>        secrets file = /home/ftpuser/rsync/rsync.secret
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mkdir -p /home/ftpuser/rsync
</span></span><span style=display:flex><span>nano /home/ftpuser/rsync/rsync.secret
</span></span><span style=display:flex><span>ftpuser:PASSWORD
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>###################################
</span></span><span style=display:flex><span># client
</span></span><span style=display:flex><span># 以 root 建立密碼檔 vi /home/rsyncpasswd
</span></span><span style=display:flex><span>!QAZ2wsx#EDC
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># 修改權限 chmod 600 /home/rsyncpasswd
</span></span><span style=display:flex><span># 測試傳輸
</span></span><span style=display:flex><span>rsync -arvzh DB log  ftpuser@10.201.102.24::ftp  --password-file=/home/rsyncpasswd
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># 定時執行 vi /var/spool/cron/crontabs/root
</span></span><span style=display:flex><span># 新增
</span></span><span style=display:flex><span>* 1 * * * rsync -arvzh DB log  ftpuser@10.201.102.24::ftp  --password-file=/home/rsyncpasswd
</span></span></code></pre></div><h3 id=tar-自動建立日期>tar 自動建立日期</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>#backup VM
</span></span><span style=display:flex><span>#ap1
</span></span><span style=display:flex><span>tar zcfP \
</span></span><span style=display:flex><span>/SystemBackup/image/IBM_SAS/vm-106-disk-0_$(date +%F).tar.gz \
</span></span><span style=display:flex><span>/IBM_SAS/images/106/vm-106-disk-0.qcow2 --warning=none
</span></span></code></pre></div><h3 id=sudo>sudo</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span># add sudo 權限
</span></span><span style=display:flex><span>adduser username
</span></span><span style=display:flex><span>passwd username
</span></span><span style=display:flex><span>usermod -aG wheel username
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>## or 
</span></span><span style=display:flex><span># 查詢所屬 group
</span></span><span style=display:flex><span># groups &lt;user&gt;
</span></span><span style=display:flex><span>WEICLOUD\chw@testlinux1 ~]$ groups  WEICLOUD\\chw
</span></span><span style=display:flex><span>WEICLOUD\chw : WEICLOUD\domain^users WEICLOUD\domain^admins WEICLOUD\aa_users WEICLOUD\sudousers WEICLOUD\denied^rodc^password^replication^group
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># edit /etc/sudoers
</span></span><span style=display:flex><span># 新增
</span></span><span style=display:flex><span>%WEICLOUD\\domain^users  ALL=(ALL)       ALL
</span></span></code></pre></div><h3 id=smartctl-查看硬碟資訊>smartctl 查看硬碟資訊</h3><blockquote><p>smartctl -i /dev/sdb</p></blockquote><h3 id=detect-the-desktop-environment>Detect the Desktop Environment</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>How to Detect the Desktop Environment in Linux Command Line
</span></span><span style=display:flex><span>ps -e | grep -E -i &#34;xfce|kde|gnome&#34;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># or
</span></span><span style=display:flex><span># 在 x-windows 環境下才有用
</span></span><span style=display:flex><span>echo $XDG_CURRENT_DESKTOP
</span></span></code></pre></div></div><footer class=post-footer><div class=post-tags><a href=/tags/linux rel=tag title=linux>#linux#</a>
<a href=/tags/centos rel=tag title=centos>#centos#</a>
<a href=/tags/rocky-linux rel=tag title="rocky linux">#rocky linux#</a></div><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//bu-jue-ming-shi.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a>
></footer></article></section></div></div><div class=sidebar-toggle><div class=sidebar-toggle-line-wrap><span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
<span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
<span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id=sidebar class=sidebar><div class=sidebar-inner><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target=post-toc-wrap>文章目錄</li><li class=sidebar-nav-overview data-target=site-overview>網站導覽</li></ul><section class="site-overview sidebar-panel"><div class="site-author motion-element" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image src=/img/avatar.png alt=Owan><p class=site-author-name itemprop=name>Owan</p><p class="site-description motion-element" itemprop=description>愛貓如癡</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href=/post/><span class=site-state-item-count>131</span>
<span class=site-state-item-name>日誌</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>29</span>
<span class=site-state-item-name>分類</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>37</span>
<span class=site-state-item-name>標籤</span></a></div></nav><div class="links-of-author motion-element"><span class=links-of-author-item><a href=https://github.com/lovesharepc/ target=_blank title=GitHub><i class="fa fa-fw fa-github"></i>
GitHub</a></span></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class=post-toc><div class=post-toc-content><nav id=TableOfContents><ul><li><a href=#virtualbox-guest-additions>virtualbox guest additions</a></li><li><a href=#監控類>監控類</a><ul><li><a href=#journalctl>journalctl</a></li><li><a href=#iostat>iostat</a></li></ul></li><li><a href=#centos-8-python>centos 8 python</a><ul><li><a href=#網路流量>網路流量</a></li></ul></li><li><a href=#帳號控制>帳號控制</a></li><li><a href=#repository>Repository</a></li><li><a href=#多工指令>多工指令</a></li><li><a href=#時間>時間</a></li><li><a href=#mount>Mount</a></li><li><a href=#du-查空間>du 查空間</a></li><li><a href=#yum>yum</a></li><li><a href=#網路設定-nmcli>網路設定 nmcli</a></li><li><a href=#其他>其他</a><ul><li><a href=#tcpdump>tcpdump</a></li><li><a href=#proxy>Proxy</a></li><li><a href=#系統版本>系統版本</a></li><li><a href=#openjdk>openjdk</a></li><li><a href=#dnsperf>dnsperf</a></li><li><a href=#firewall-cmd>firewall-cmd</a></li><li><a href=#lvm-修復>LVM 修復</a></li><li><a href=#local-domain-resolve>local domain Resolve</a></li><li><a href=#samba>SAMBA</a></li><li><a href=#redhat-59-rsyslog>redhat 5.9 rsyslog</a></li><li><a href=#aliases>Aliases</a></li><li><a href=#screen>screen</a></li><li><a href=#coredns--server>coreDNS server</a></li><li><a href=#mtu-test>MTU test</a></li><li><a href=#webmin>webmin</a></li><li><a href=#iscsi>iSCSI</a></li><li><a href=#rsync>Rsync</a></li><li><a href=#tar-自動建立日期>tar 自動建立日期</a></li><li><a href=#sudo>sudo</a></li><li><a href=#smartctl-查看硬碟資訊>smartctl 查看硬碟資訊</a></li><li><a href=#detect-the-desktop-environment>Detect the Desktop Environment</a></li></ul></li></ul></nav></div></div></section></div></aside></div></main><footer id=footer class=footer><div class=footer-inner><div class=copyright><span class=copyright-year>&copy; 2010 - 2022</span>
<span class=with-love><i class="fa fa-heart"></i></span>
<span class=copyright-author>補覺鳴詩</span></div><div class=powered-info><span class=powered-by>Powered by - <a class=powered-link href=//gohugo.io target=_blank title=hugo>Hugo v0.96.0</a></span>
<span class=separator-line>/</span>
<span class=theme-info>Theme by - <a class=powered-link href=//github.com/elkan1788/hugo-theme-next target=_blank>NexT</a></span></div><div class=vistor-info></div></div></footer><div class=back-to-top><i class="fa fa-arrow-up"></i>
<span id=scrollpercent><span>0</span>%</span></div></div><script type=text/javascript src=//cdn.bootcdn.net/ajax/libs/jquery/2.1.4/jquery.min.js></script>
<script type=text/javascript src=/js/search.js></script>
<script type=text/javascript src=/js/affix.js></script>
<script type=text/javascript src=/js/scrollspy.js></script>
<script type=text/javascript>function detectIE(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),n=e.indexOf("Trident/"),s=e.indexOf("Edge/");return t>0||n>0||s>0?-1:1}function getCntViewHeight(){var t=$("#content").height(),e=$(window).height(),n=t>e?t-e:$(document).height()-e;return n}function getScrollbarWidth(){var e=$("<div />").addClass("scrollbar-measure").prependTo("body"),t=e[0],n=t.offsetWidth-t.clientWidth;return e.remove(),n}function registerBackTop(){var t=50,e=$(".back-to-top");$(window).on("scroll",function(){e.toggleClass("back-to-top-on",window.pageYOffset>t);var s=$(window).scrollTop(),o=getCntViewHeight(),i=s/o,n=Math.round(i*100),a=n>100?100:n;$("#scrollpercent>span").html(a)}),e.on("click",function(){$("html,body").animate({scrollTop:0,screenLeft:0},800)})}function initScrollSpy(){var e=".post-toc",s=$(e),t=".active-current";s.on("activate.bs.scrollspy",function(){var t=$(e+" .active").last();n(),t.addClass("active-current")}).on("clear.bs.scrollspy",n),$("body").scrollspy({target:e});function n(){$(e+" "+t).removeClass(t.substring(1))}}function initAffix(){var e=$(".header-inner").height(),t=parseInt($(".main").css("padding-bottom"),10),n=e+10;$(".sidebar-inner").affix({offset:{top:n,bottom:t}}),$(document).on("affixed.bs.affix",function(){updateTOCHeight(document.body.clientHeight-100)})}function initTOCDimension(){$(window).on("resize",function(){e&&clearTimeout(e),e=setTimeout(function(){var e=document.body.clientHeight-100;updateTOCHeight(e)},0)}),updateTOCHeight(document.body.clientHeight-100);var e,t=getScrollbarWidth();$(".post-toc").css("width","calc(100% + "+t+"px)")}function updateTOCHeight(e){e=e||"auto",$(".post-toc").css("max-height",e)}$(function(){var t=$(".header-inner").height()+10,n,s,e,o;$("#sidebar").css({'margin-top':t}).show(),n=parseInt($("#sidebar").css("margin-top")),s=parseInt($(".sidebar-inner").css("height")),e=n+s,o=$(".content-wrap").height(),o<e&&$(".content-wrap").css("min-height",e),$(".site-nav-toggle").on("click",function(){var e=$(".site-nav"),o=$(".toggle"),t="site-nav-on",i="toggle-close",n=e.hasClass(t),a=n?"slideUp":"slideDown",s=n?"removeClass":"addClass";e.stop()[a]("normal",function(){e[s](t),o[s](i)})}),registerBackTop(),initScrollSpy(),initAffix(),initTOCDimension(),$(".sidebar-nav-toc").click(function(){$(this).addClass("sidebar-nav-active"),$(this).next().removeClass("sidebar-nav-active"),$("."+$(this).next().attr("data-target")).toggle(500),$("."+$(this).attr("data-target")).toggle(500)}),$(".sidebar-nav-overview").click(function(){$(this).addClass("sidebar-nav-active"),$(this).prev().removeClass("sidebar-nav-active"),$("."+$(this).prev().attr("data-target")).toggle(500),$("."+$(this).attr("data-target")).toggle(500)})})</script><script src=//cdn.bootcdn.net/ajax/libs/imageviewer/0.1.0/viewer.min.js></script>
<script type=text/javascript>$(function(){$(".post-body").viewer()})</script><script>(function(){var e=document.createElement("script"),t,n=window.location.protocol.split(":")[0];n==="https"?e.src="https://zz.bdstatic.com/linksubmit/push.js":e.src="http://push.zhanzhang.baidu.com/push.js",t=document.getElementsByTagName("script")[0],t.parentNode.insertBefore(e,t)})()</script></body></html>